<main class="page-section" *ngIf="auth.user?.role === 'admin'; else redirecting">
  <div class="mx-auto max-w-6xl px-4">
    <header class="mb-10 text-center">
      <h1 class="section-title">Admin control centre</h1>
      <p class="section-subtitle">
        Monitor live orders across all customers and update statuses in real time.
      </p>
    </header>

    <p *ngIf="loading" class="text-sm text-muted">Loading orders...</p>
    <p *ngIf="error" class="text-sm text-red-500">{{ error }}</p>

    <div class="mt-6 grid gap-4">
      <div *ngFor="let order of orders" class="card space-y-4">
        <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
          <div>
            <p class="text-sm font-semibold text-primary">Order #{{ order.id }}</p>
            <p class="text-sm text-muted">Customer: {{ order.customer_name || order.customerId }}</p>
            <p class="text-sm text-muted">{{ formatItems(order) }}</p>
          </div>
          <div class="text-right text-sm text-muted">
            <p class="font-semibold text-accent">${{ totalFor(order) }}</p>
            <p>Placed {{ createdAt(order) }}</p>
          </div>
        </div>
        <div class="flex flex-wrap items-center gap-3">
          <button
            *ngFor="let status of orderStatuses"
            type="button"
            (click)="updateStatus(order.id, status)"
            [disabled]="updatingId === order.id"
            class="rounded-full border px-4 py-1.5 text-sm font-medium transition"
            [ngClass]="order.status === status
              ? 'border-[var(--accent)] bg-[var(--accent)] text-[var(--accent-contrast)]'
              : 'border-[var(--card-border)] bg-[var(--surface-layer)] text-secondary hover:border-[var(--accent)] hover:text-accent'"
          >
            {{ status }}
          </button>
        </div>
      </div>
      <p *ngIf="!loading && orders.length === 0" class="text-sm text-muted">No orders found yet. Encourage customers to place new orders.</p>
    </div>
  </div>
</main>
<ng-template #redirecting>
  <main class="page-section">
    <div class="mx-auto max-w-3xl px-4">
      <p class="text-sm text-muted">Redirecting...</p>
    </div>
  </main>
</ng-template>
