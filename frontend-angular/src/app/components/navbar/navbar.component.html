<header class="nav-surface sticky top-0 z-40 shadow-sm">
  <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3">
    <a routerLink="/" class="flex items-center gap-3">
      <div class="flex h-10 w-10 items-center justify-center rounded-full bg-[var(--accent)] text-white shadow-lg">
        <span class="text-lg font-bold">CCD</span>
      </div>
      <span class="brand-title text-lg font-semibold text-primary sm:text-xl">Cafe Coffee Day</span>
    </a>

    <nav class="hidden items-center gap-6 text-sm font-semibold md:flex">
      <a
        *ngFor="let link of links"
        routerLink="{{ link.to }}"
        routerLinkActive="text-accent"
        class="text-secondary transition hover:text-accent"
      >
        {{ link.label }}
      </a>
      <a
        routerLink="/orders"
        class="relative inline-flex items-center gap-2 rounded-full border border-[var(--card-border)] bg-[var(--surface-layer)] px-3 py-1.5 text-xs font-semibold text-secondary transition hover:text-accent"
      >
        <span class="material-symbols-outlined text-sm">shopping_bag</span>
        Cart
        <span
          *ngIf="cartCount > 0"
          class="absolute -right-2 -top-2 flex h-5 w-5 items-center justify-center rounded-full bg-[var(--accent)] text-xs font-bold text-[var(--accent-contrast)] shadow"
        >
          {{ cartCount }}
        </span>
      </a>
      <app-theme-switcher></app-theme-switcher>
      <ng-container *ngIf="user; else guestActions">
        <div class="flex items-center gap-3">
          <span *ngIf="displayName" class="hidden text-sm font-semibold text-primary lg:inline">{{ displayName }}</span>
          <button
            type="button"
            (click)="logout()"
            class="rounded-full border border-[var(--card-border)] px-4 py-1.5 text-sm font-medium text-secondary transition hover:border-[var(--accent)] hover:text-accent"
          >
            Logout
          </button>
        </div>
      </ng-container>
      <ng-template #guestActions>
        <div class="flex items-center gap-3">
          <a class="btn-primary" routerLink="/login">Login</a>
          <a
            class="rounded-full border border-[var(--accent)] px-5 py-2 text-sm font-semibold text-accent transition hover:bg-[var(--accent-soft)]"
            routerLink="/register"
          >
            Join Us
          </a>
        </div>
      </ng-template>
    </nav>

    <button
      type="button"
      class="inline-flex items-center justify-center rounded-full bg-[var(--surface-layer)] p-2 text-secondary shadow-md transition hover:shadow-lg md:hidden"
      (click)="toggleOpen()"
    >
      <span class="material-symbols-outlined text-xl">{{ open ? 'close' : 'menu' }}</span>
    </button>
  </div>

  <div *ngIf="open" class="border-t border-[var(--border-contrast)] bg-[var(--surface-layer)] px-4 py-4 backdrop-blur-xl md:hidden">
    <div class="flex flex-col gap-4 text-sm font-semibold text-secondary">
      <a *ngFor="let link of links" routerLink="{{ link.to }}" (click)="toggleOpen()">{{ link.label }}</a>
      <a routerLink="/orders" (click)="toggleOpen()" class="flex items-center gap-2">
        <span class="material-symbols-outlined text-base">shopping_bag</span> Cart ({{ cartCount }})
      </a>
      <div class="border-t border-[var(--border-contrast)] pt-3">
        <app-theme-switcher></app-theme-switcher>
      </div>
      <ng-container *ngIf="user; else mobileGuest">
        <span *ngIf="displayName" class="text-sm text-primary">Signed in as {{ displayName }}</span>
        <button type="button" (click)="logout()" class="text-left text-accent">Logout</button>
      </ng-container>
      <ng-template #mobileGuest>
        <div class="flex flex-col gap-2">
          <a class="btn-primary w-full justify-center" routerLink="/login" (click)="toggleOpen()">Login</a>
          <a
            class="rounded-full border border-[var(--accent)] px-5 py-2 text-center text-sm font-semibold text-accent"
            routerLink="/register"
            (click)="toggleOpen()"
          >
            Join Us
          </a>
        </div>
      </ng-template>
    </div>
  </div>
</header>
